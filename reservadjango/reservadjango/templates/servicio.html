{% extends 'base.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>
    <title>{% block title %}Servicio{% endblock %}</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="{% static 'style.css' %}">
</head>

{% block content %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
  <!-- Logo -->
  <a class="navbar-brand" href="/"><img src="{% static 'logo.png' %}" alt="Logo" height="40"></a>
  <!-- Navbar Links -->
  <div class="collapse navbar-collapse" id="navbarNavDropdown">
      <ul class="d-flex list-unstyled">
          <li class="nav-item2">
              <a class="nav-link" href="{% url 'index' %}">Inicio</a>
          </li>
          <li class="nav-item2 dropdown">
              <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                  Categorias
              </a>
              <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
                  <a class="dropdown-item" href="/">Todos los productos</a>
                  <!-- Loop through categories and generate dropdown items -->
              </div>
          </li>
          <li class="nav-item2 reservar-hora">
            <a class="nav-link" href="{% url 'reserva' %}">Reservar cita</a>
        </li>
      </ul>
  </div>
  <div class="ml-auto mr-2">
    <button class="btn btn-outline-light" type="button" id="carrito" onclick="window.location.href='{% url 'cart:cart_summary' %}'">
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-cart" viewBox="0 0 16 16">
            <path d="M0 1.5A.5.5 0 0 1 .5 1H2a.5.5 0 0 1 .485.379L2.89 3H14.5a.5.5 0 0 1 .491.592l-1.5 8A.5.5 0 0 1 13 12H4a.5.5 0 0 1-.491-.408L2.01 3.607 1.61 2H.5a.5.5 0 0 1-.5-.5M3.102 4l1.313 7h8.17l1.313-7zM5 12a2 2 0 1 0 0 4 2 2 0 0 0 0-4m7 0a2 2 0 1 0 0 4 2 2 0 0 0 0-4m-7 1a1 1 0 1 1 0 2 1 1 0 0 1 0-2m7 0a1 1 0 1 1 0 2 1 1 0 0 1 0-2"/>
        </svg>
        <span class="badge bg-dark text-white ms-1 rounded-pill" id="cart_quantity">{{ cart|length }}</span>
    </button>
</div>
  <!-- User Dropdown -->
  {% if user.is_authenticated %}
  <div class="dropdown">
      <button class="btn btn-danger dropdown-toggle" type="button" id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
          {{ user.email }}
      </button>
      <div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
          <a class="dropdown-item" href="{% url 'mis_reservas' %}">Mis reservas</a>
          <a class="dropdown-item" href="{% url 'accounts:update_user' %}">Actualizar usuario</a>
          <a class="dropdown-item" href="{% url 'accounts:update_user_info' %}">Informacion del usuario</a>
          <a class="dropdown-item" href="{% url 'payment:billing_info' %}">Información de facturación</a>
          <a class="dropdown-item" href="{% url 'password_change' %}">Cambiar contraseña</a>
          <form action="{% url 'logout' %}" method="post">
              {% csrf_token %}
              <button type="submit" class="dropdown-item">Cerrar sesión</button>
          </form>
          {% else %}
          <a class="btn btn-danger" href="{% url 'accounts:login' %}">Iniciar sesión</a>
          <a class="btn btn-danger" href="{% url 'accounts:signup' %}">Registrarse</a>
          {% endif %}
      </div>
  </div>
</nav>

<br>
<div class="container">
    <br>
    <div class="form-container">
        {% for message in messages %}
        <div class="alert alert-secondary" role="alert">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    <div class="card mb-3" style="max-height: 600px;">
        <div class="row g-0">
            <div class="col-md-8 d-flex justify-content-center" style="padding-top: 10px; padding-bottom: 10px; border-right: 1px solid #ccc;">
                <img src="{{servicio.imagen.url}}" class="img-fluid rounded-start" style="max-height: 500px; width: auto;">
            </div>
            <div class="col-md-4">
                <div class="card-body">
                    <h2 class="card-title" style="font-weight: bolder; font-size: 32px;">{{servicio.nombre}}</h2>
                    <p class="card-text" style="font-size: 18px;">This is a wider card with supporting text below as a natural lead-in to additional content. This content is a little bit longer.</p>
                    {% if servicio.descuento %}
                    <div class="d-flex align-items-center" style="margin-top: 30px;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="red" class="bi bi-fire mr-2" viewBox="0 0 16 16">
                            <path d="M8 16c3.314 0 6-2 6-5.5 0-1.5-.5-4-2.5-6 .25 1.5-1.25 2-1.25 2C11 4 9 .5 6 0c.357 2 .5 4-2 6-1.25 1-2 2.729-2 4.5C2 14 4.686 16 8 16m0-1c-1.657 0-3-1-3-2.75 0-.75.25-2 1.25-3C6.125 10 7 10.5 7 10.5c-.375-1.25.5-3.25 2-3.5-.179 1-.25 2 1 3 .625.5 1 1.364 1 2.25C11 14 9.657 15 8 15"/>
                        </svg>
                        <span class="font-weight-bold text-danger" style="font-size: 24px;">¡Oferta!</span>
                    </div>
                    <h4 class="card-text"><strike>${{servicio.precio}}</strike> &nbsp; ${{servicio.precio_descuento}}</h4>
                    {% else %}
                    <h4 class="card-text">${{servicio.precio}}</h4>
                    {% endif %}
                    <br>
                    <div class="row align-items-center">
                        <div class="col-md-3" style="font-size: 18px;">Cantidad:</div>
                        <div class="col-md-2"> 
                            <select class="form-select form-select-sm w-100" id="qty-cart">
                                <option value="1">1</option>
                                <option value="2">2</option>
                                <option value="3">3</option>
                                <option value="4">4</option>
                                <option value="5">5</option>
                            </select> 
                        </div>
                    </div>
                    <br><br>
                    <!-- Button is kept in place -->
                    <button type="button" value="{{ servicio.id }}" id="add-cart-{{ servicio.id }}" class="btn btn-danger btn-block">Agregar al carrito</button>
                </div>
            </div>
        </div>
    </div>
    <br>
    <button type="button" class="btn btn-success btn-block" onclick="window.location.href='/'">Volver al inicio</button>  
</div>

{% endblock %}